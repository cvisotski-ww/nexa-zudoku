{"version":3,"file":"MdxPage-C3tlrV4j.js","sources":["../src/lib/plugins/markdown/Toc.tsx","../src/lib/plugins/markdown/MdxPage.tsx"],"sourcesContent":["import type { TocEntry } from \"@stefanprobst/rehype-extract-toc\";\nimport { ListTreeIcon } from \"lucide-react\";\nimport {\n  useEffect,\n  useRef,\n  useState,\n  type CSSProperties,\n  type PropsWithChildren,\n} from \"react\";\nimport { AnchorLink } from \"../../components/AnchorLink.js\";\nimport { useViewportAnchor } from \"../../components/context/ViewportAnchorContext.js\";\nimport { cn } from \"../../util/cn.js\";\n\nconst DATA_ANCHOR_ATTR = \"data-active\";\n\nconst TocItem = ({\n  item,\n  children,\n  className,\n  isActive,\n}: PropsWithChildren<{\n  item: TocEntry;\n  isActive: boolean;\n  className?: string;\n}>) => {\n  return (\n    <li\n      className={cn(\n        \"truncate\",\n        isActive\n          ? \"text-primary\"\n          : \"text-foreground/65 dark:text-foreground/75\",\n        className,\n      )}\n      title={item.value}\n    >\n      <AnchorLink\n        to={`#${item.id}`}\n        {...{ [DATA_ANCHOR_ATTR]: item.id }}\n        className={cn(\n          isActive\n            ? \"text-primary\"\n            : \"text-foreground/65 dark:text-foreground/75 hover:text-foreground\",\n        )}\n      >\n        {item.value}\n      </AnchorLink>\n      {children}\n    </li>\n  );\n};\n\nexport const Toc = ({ entries }: { entries: TocEntry[] }) => {\n  const { activeAnchor } = useViewportAnchor();\n  const listWrapperRef = useRef<HTMLUListElement>(null);\n  const paintedOnce = useRef(false);\n  const [indicatorStyle, setIndicatorStyles] = useState<CSSProperties>({\n    top: 0,\n    opacity: 0,\n  });\n\n  // synchronize active anchor indicator with the scroll position\n  useEffect(() => {\n    if (!listWrapperRef.current) return;\n\n    const activeElement = listWrapperRef.current.querySelector(\n      `[${DATA_ANCHOR_ATTR}='${activeAnchor}']`,\n    );\n\n    if (!activeElement) {\n      setIndicatorStyles({ top: 0, opacity: 0 });\n      return;\n    }\n\n    const topParent = listWrapperRef.current.getBoundingClientRect().top;\n    const topElement = activeElement.getBoundingClientRect().top;\n\n    setIndicatorStyles({\n      opacity: 1,\n      top: `${topElement - topParent}px`,\n    });\n\n    if (paintedOnce.current) return;\n\n    // after all is painted, the indicator should animate\n    requestIdleCallback(() => {\n      paintedOnce.current = true;\n    });\n  }, [activeAnchor]);\n\n  return (\n    <aside className=\"sticky scrollbar top-[--header-height] h-[calc(100vh-var(--header-height))] pt-[--padding-content-top] pb-[--padding-content-bottom] overflow-y-auto ps-1 text-sm\">\n      <div className=\"flex items-center gap-2 font-medium mb-2\">\n        <ListTreeIcon size={16} />\n        On this page\n      </div>\n      <div className=\"relative ms-2 ps-4\">\n        <div className=\"absolute inset-0 right-auto bg-border w-[2px]\" />\n        <div\n          className={cn(\n            \"absolute -left-px -translate-y-1 h-6 w-[4px] rounded bg-primary\",\n            paintedOnce.current &&\n              \"ease-out [transition:top_150ms,opacity_325ms]\",\n          )}\n          style={indicatorStyle}\n        />\n        <ul\n          ref={listWrapperRef}\n          className=\"relative font-medium list-none space-y-2\"\n        >\n          {entries.map((item) => (\n            <TocItem\n              isActive={item.id === activeAnchor}\n              key={item.id}\n              item={item}\n              className=\"pl-0\"\n            >\n              {item.children && (\n                <ul className=\"list-none pl-4 pt-2 space-y-2\">\n                  {item.children.map((child) => (\n                    <TocItem\n                      item={child}\n                      isActive={child.id === activeAnchor}\n                      key={child.id}\n                    />\n                  ))}\n                </ul>\n              )}\n            </TocItem>\n          ))}\n        </ul>\n      </div>\n    </aside>\n  );\n};\n","import { useMDXComponents } from \"@mdx-js/react\";\nimport slugify from \"@sindresorhus/slugify\";\nimport { Helmet } from \"@zudoku/react-helmet-async\";\nimport { type PropsWithChildren } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport { CategoryHeading } from \"../../components/CategoryHeading.js\";\nimport { Heading } from \"../../components/Heading.js\";\nimport { ProseClasses } from \"../../components/Markdown.js\";\nimport {\n  useCurrentItem,\n  usePrevNext,\n} from \"../../components/navigation/utils.js\";\nimport type { MdxComponentsType } from \"../../util/MdxComponents.js\";\nimport { cn } from \"../../util/cn.js\";\nimport { Toc } from \"./Toc.js\";\nimport { MarkdownPluginDefaultOptions, MDXImport } from \"./index.js\";\n\nconst MarkdownHeadings = {\n  h2: ({ children, id }) => (\n    <Heading level={2} id={id} registerSidebarAnchor>\n      {children}\n    </Heading>\n  ),\n  h3: ({ children, id }) => (\n    <Heading level={3} id={id} registerSidebarAnchor>\n      {children}\n    </Heading>\n  ),\n} satisfies MdxComponentsType;\n\nexport const MdxPage = ({\n  mdxComponent: MdxComponent,\n  frontmatter = {},\n  defaultOptions,\n  tableOfContents,\n}: PropsWithChildren<\n  Omit<MDXImport, \"default\"> & {\n    mdxComponent: MDXImport[\"default\"];\n    defaultOptions?: MarkdownPluginDefaultOptions;\n  }\n>) => {\n  const categoryTitle = useCurrentItem()?.categoryLabel;\n  const title = frontmatter.title;\n  const category = frontmatter.category ?? categoryTitle;\n  const hideToc = frontmatter.toc === false || defaultOptions?.toc === false;\n  const pageTitle =\n    tableOfContents.find((item) => item.depth === 1)?.value ?? title;\n  const hidePager =\n    frontmatter.disablePager ?? defaultOptions?.disablePager ?? false;\n\n  const tocEntries =\n    tableOfContents.find((item) => item.depth === 1)?.children ??\n    // if `title` is provided by frontmatter it does not appear in the table of contents\n    tableOfContents.filter((item) => item.depth === 2);\n\n  const showToc = !hideToc && tocEntries.length > 0;\n\n  const { prev, next } = usePrevNext();\n\n  return (\n    <div className=\"xl:grid grid-cols-[--sidecar-grid-cols] gap-8 justify-between\">\n      <Helmet>\n        <title>{pageTitle}</title>\n      </Helmet>\n      <div\n        className={cn(\n          ProseClasses,\n          \"max-w-full xl:w-full xl:max-w-prose flex-1 flex-shrink pt-[--padding-content-top] pb-[--padding-content-bottom]\",\n        )}\n      >\n        <header>\n          {category && <CategoryHeading>{category}</CategoryHeading>}\n          {title && (\n            <Heading level={1} id={slugify(title)}>\n              {title}\n            </Heading>\n          )}\n        </header>\n        <MdxComponent\n          components={{ ...useMDXComponents(), ...MarkdownHeadings }}\n        />\n        {!hidePager && (\n          <>\n            <hr />\n            <div className=\"not-prose flex flex-wrap items-center justify-between gap-2 lg:gap-8\">\n              {prev ? (\n                <Link\n                  to={prev.id}\n                  className=\"flex flex-col items-stretch gap-2 flex-1 min-w-max border rounded px-6 py-4 text-start hover:border-primary/85 transition shadow-sm hover:shadow-md\"\n                  title={prev.label}\n                >\n                  <div className=\"text-sm text-muted-foreground\">\n                    ← Previous page\n                  </div>\n                  <div className=\"text-lg text-primary truncate\">\n                    {prev.label}\n                  </div>\n                </Link>\n              ) : (\n                <div className=\"flex-1\" />\n              )}\n              {next ? (\n                <Link\n                  to={next.id}\n                  className=\"flex flex-col items-stretch gap-2 flex-1 min-w-max border rounded px-6 py-4 text-end hover:border-primary/85 transition shadow-sm hover:shadow-md\"\n                  title={next.label}\n                >\n                  <div className=\"text-sm text-muted-foreground\">\n                    Next page →\n                  </div>\n                  <div className=\"text-lg text-primary truncate\">\n                    {next.label}\n                  </div>\n                </Link>\n              ) : (\n                <div className=\"flex-1\" />\n              )}\n            </div>\n          </>\n        )}\n      </div>\n      <div className=\"hidden xl:block\">\n        {showToc && <Toc entries={tocEntries} />}\n      </div>\n    </div>\n  );\n};\n"],"names":["DATA_ANCHOR_ATTR","TocItem","item","children","className","isActive","jsxs","cn","jsx","AnchorLink","Toc","entries","activeAnchor","useViewportAnchor","listWrapperRef","useRef","paintedOnce","indicatorStyle","setIndicatorStyles","useState","useEffect","activeElement","topParent","topElement","ListTreeIcon","child","MarkdownHeadings","id","Heading","MdxPage","MdxComponent","frontmatter","defaultOptions","tableOfContents","categoryTitle","_a","useCurrentItem","title","category","hideToc","pageTitle","_b","hidePager","tocEntries","_c","showToc","prev","next","usePrevNext","Helmet","ProseClasses","CategoryHeading","slugify","useMDXComponents","Fragment","Link"],"mappings":"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"}